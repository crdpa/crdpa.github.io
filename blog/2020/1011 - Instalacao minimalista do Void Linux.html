<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>crdpa – 1011 - Instalacao minimalista do Void Linux</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #232629;
        color: #7a7c7d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
    div.sourceCode
      { color: #cfcfc2; background-color: #232629; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cfcfc2; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #3f8058; } /* Annotation */
    code span.at { color: #2980b9; } /* Attribute */
    code span.bn { color: #f67400; } /* BaseN */
    code span.bu { color: #7f8c8d; } /* BuiltIn */
    code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #3daee9; } /* Char */
    code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
    code span.co { color: #7a7c7d; } /* Comment */
    code span.cv { color: #7f8c8d; } /* CommentVar */
    code span.do { color: #a43340; } /* Documentation */
    code span.dt { color: #2980b9; } /* DataType */
    code span.dv { color: #f67400; } /* DecVal */
    code span.er { color: #da4453; text-decoration: underline; } /* Error */
    code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
    code span.fl { color: #f67400; } /* Float */
    code span.fu { color: #8e44ad; } /* Function */
    code span.im { color: #27ae60; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
    code span.op { color: #cfcfc2; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #27ae60; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #f44f4f; } /* String */
    code span.va { color: #27aeae; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href="/styles.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="instalação-minimalista-da-distribuição-void-linux">Instalação minimalista da distribuição Void Linux</h1>
<h2 id="section">11/10/2020</h2>
<p>Este guia é um passo a passo de como instalar a distribuição Void Linux de maneira manual e bastante enxuta. É um meio alternativo de se instalar e selecionar a dedo cada componente que fará parte do seu sistema.</p>
<p>Quando me aventurei no Linux pela primeira vez, com o Mandrake, sempre tive a sensação de que o sistema era um pouco cheio de pacotes e softwares redundantes. Isso vem da época que as distribuições vinham em vários CDs. Até que um dia me deparei com Slackware e comecei a entender como tudo funcionava por baixo dos panos.</p>
<p>Anos se passaram e com toda a experiência adquirida, finalmente achei meu lar na distribuição Gentoo. Como vocês devem saber, o Gentoo da um bocado de trabalho pra instalar e manter, mas depois que se pega o jeito você acaba até adquirindo um certo apego, pois conhece tudo no seu sistema e sabe exatamente como e porque as coisas funcionam. Um certo dia acabei formatando sem querer a partição onde o Gentoo estava instalado e não havia nenhum backup. A idéia de começar tudo do zero, configurar e recompilar o kernel, me deixou extremamente desanimado.</p>
<p>Foi aí que me deparei com o Void Linux.</p>
<p>Simples, minimalista, rápido e sem necessidade de configurar o próprio kernel. Não senti a mínima vontade de voltar para o Gentoo, apesar de ainda me passar pela cabeça uma ou duas vezes no ano.</p>
<p>Eu pensei até que estaria aos poucos abandonando essa idéia de ter um sistema minimalista e simplificado. O que me fez algumas vezes migrar para distribuições mais automatizadas como Manjaro ou Fedora, mas após utilizar por duas ou três semanas acabo voltando para o Void.</p>
<p>Eu sempre fico com aquela sensação de falta de controle das coisas. Onde tudo acontece nos bastidores, um monte de pacotes e softwares desnecessários são instalados, serviços demais rodando, pra fazer exatamente a mesma coisa que eu fazia no Void (ou Gentoo) de maneira mais rápida e utilizando menos recursos.</p>
<p>Já ficou claro que esse é um texto/guia bem particular. Não significa que essa seja a maneira certa de se manter um sistema operacional e que utilizar Fedora ou Ubuntu signifique que você não tenha controle do seu sistema. Pelo contrário. Acredito que a maioria dos administradores de sistemas Linux utilizam esse tipo de distribuição. Essa é só a maneira como cresci e me envolvi com Linux e como prefiro lidar com o meu computador.</p>
<p>Caso você prefira instalar rapidamente e já ter tudo pronto para utilizar, esse guia não é para você. Esse texto assume que você tem alguns conhecimentos básicos de Linux.</p>
<h2 id="formatando-e-particionando">Formatando e particionando</h2>
<p>Eu prefiro utilizar outra distribuição para instalar o Void Linux, pois apesar das imagens do Void serem suficiente, gosto de ter um sistema mais completo e automatizado para fazer outras coisas enquanto instalo e também para não correr riscos de faltar algum software especĩfico. Pode ser Fedora, Ubuntu, Manjaro ou mesmo o Void Linux, fica a seu critério.</p>
<p>Assim que baixar a distribuição de sua escolha, crie o seu pendrive USB bootável. No meu caso, escolhi o Manjaro XFCE.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="fu">dd</span> if=manjaro-xfce.iso of=/dev/sdc <span class="co"># /dev/sdc é o meu pendrive</span></span></code></pre></div>
<p>Agora é só reiniciar o computador e bootar no pendrive.</p>
<p>Feito isso, é hora de particionar. No Manjaro eu utilizo o GParted para facilitar o processo. Irei utilizar o sistema de arquivos btrfs para a partição raiz. Tudo ficará dessa maneira:</p>
<p>/dev/sda1: fat32, 600MB (partição EFI onde ficará o kernel)</p>
<p>/dev/sda2: ext4, 1 GB (partição /boot)</p>
<p>/dev/sda3: btrfs (restante do espaço onde ficará a partição raiz e diretório home)</p>
<p>Montando a partição raiz e criando subvolumes no sistema de arquivos btrfs:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime,ssd,compress=zstd,space_cache,commit=120 /dev/sda3 /mnt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="ex">btrfs</span> subvolume create /mnt/@</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="ex">btrfs</span> subvolume create /mnt/@home</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="ex">btrfs</span> subvolume create /mnt/@snapshots</span></code></pre></div>
<p>Agora desmonte a partição para remontarmos novamente utilizando os subvolumes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="fu">umount</span> /mnt</span></code></pre></div>
<h2 id="montando-todas-as-partições-e-instalando-void-linux">Montando todas as partições e instalando Void Linux</h2>
<p>Montando a partição raiz e subvolumes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime,ssd,compress=zstd,space_cache,commit=120,subvol=@ /dev/sda3 /mnt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="fu">mkdir</span> /mnt/<span class="dt">{home,snapshots}</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime,ssd,compress=zstd,space_cache,commit=120,subvol=@home /dev/sda3 /mnt/home</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime,ssd,compress=zstd,space_cache,commit=120,subvol=@snapshots /dev/sda3 /mnt/snapshots</span></code></pre></div>
<p>Montando partição boot e efi:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="fu">mkdir</span> /mnt/boot</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime /dev/sda2 /mnt/boot</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="fu">mkdir</span> /mnt/boot/efi</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="fu">mount</span> -o rw,noatime /dev/sda1 /mnt/boot/efi</span></code></pre></div>
<p>Hora de instalar o sistema base. Você precisará baixar o arquivo rootfs do Void Linux no <a href="https://alpha.de.repo.voidlinux.org/live/current/">site</a>. O arquivo, no meu caso, é o void-x86_64-ROOTFS-20191109.tar.xz.</p>
<p>Assim que finalizar o download, iremos descompactar no diretório raiz do sistema que acabamos de montar:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="fu">tar</span> xvf void-x86_64-ROOTFS-20191109.tar.xz.tar.xz -C /mnt</span></code></pre></div>
<p>Agora iremos entrar no novo sistema:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="fu">mount</span> -t proc proc /mnt/proc</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="fu">mount</span> -t sysfs sys /mnt/sys</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="fu">mount</span> -o bind /dev /mnt/dev</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="fu">mount</span> -t devpts pts /mnt/dev/pts</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="fu">cp</span> -L /etc/resolv.conf /mnt/etc/</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="bu">cd</span> /mnt</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="fu">chroot</span> /mnt /bin/bash</span></code></pre></div>
<p>Pronto! Estamos no Void Linux. O próximo passo é criar a senha para o root e ajustar as permissões:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="fu">passwd</span> root</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="fu">chown</span> root:root / <span class="kw">&amp;&amp;</span> <span class="fu">chmod</span> 755 /</span></code></pre></div>
<p>Antes de seguir com a instalação, irei bloquear alguns pacotes de serem instalados.</p>
<p>No meu caso, não quero que sejam instalados os pacotes linux-firmware-amd, wpa_supplicant e dhcpcd.</p>
<p>O primeiro porque não tenho nada da AMD no meu laptop, o segundo e terceiro porque utilizarei o iwd e openresolv pra conectar o wifi. Como o iwd também tem um cliente dhcp interno, é desnecessário utilizar o dhcpcd.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&quot;ignorepkg=linux-firmware-amd&quot;</span> <span class="op">&gt;</span> /etc/xbps.d/10-ignore.conf</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&quot;ignorepkg=wpa_supplicant&quot;</span> <span class="op">&gt;&gt;</span> /etc/xbps.d/10-ignore.conf</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&quot;ignorepkg=dhcpcd&quot;</span> <span class="op">&gt;&gt;</span> /etc/xbps.d/10-ignore.conf</span></code></pre></div>
<p>Atualizando e instalando o sistema:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="ex">xbps-install</span> -Su xbps</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="ex">xbps-install</span> -u</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="ex">xbps-install</span> base-system</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a><span class="ex">xbps-remove</span> base-voidstrap</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="ex">xbps-remove</span> -o</span></code></pre></div>
<p>Instalação básica completa! Agora iremos configurar.</p>
<h2 id="configurando-o-sistema">Configurando o sistema</h2>
<p>Especifique o hostname em /etc/hostname e edite /etc/rc.conf com suas preferências.</p>
<p>Escolha a(s) localização(ões) correta(s) editando o arquivo /etc/default/libc-locales removendo o # do início da linha desejada e digite o comando a seguir:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="ex">xbps-reconfigure</span> -f glibc-locales</span></code></pre></div>
<p>Hora de editar o /etc/fstab.</p>
<p>Primeiro copie o arquivo de referência:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="fu">cp</span> /proc/mounts /etc/fstab</span></code></pre></div>
<p>Remova as linhas que começam com proc, sys, devtmpfs and pts.</p>
<p>Troque o último 0 por 1 da linha referente à partição raiz e das outras linhas troque por 2.</p>
<p>Agora a parte chata. Você deve substituir todos os /dev/sda*/ por seus respectivos UUIDS.</p>
<p>Para descobrir cada UUID, digite:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="ex">blkid</span> -s UUID</span></code></pre></div>
<p>Por fim, ajuste as linhas referentes ao /boot e /boot/efi para defaults,noatime e adicione a linha seguinte para montar /tmp na memória RAM.</p>
<p>Meu /etc/fstab ficou assim:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="va">UUID=</span>7c29705b-086c-49b6-a1ae-3b3dbf594dde <span class="ex">/</span> btrfs rw,noatime,compress=zstd:3,ssd,space_cache,commit=120,subvolid=256,subvol=/@ 0 1</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="va">UUID=</span>7c29705b-086c-49b6-a1ae-3b3dbf594dde <span class="ex">/home</span> btrfs rw,noatime,compress=zstd:3,ssd,space_cache,commit=120,subvolid=257,subvol=/@home 0 2</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a><span class="va">UUID=</span>7c29705b-086c-49b6-a1ae-3b3dbf594dde <span class="ex">/snapshots</span> btrfs rw,noatime,compress=zstd:3,ssd,space_cache,commit=120,subvolid=258,subvol=/@snaps</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a><span class="va">UUID=</span>e2f9d238-fc81-44ea-b2c4-11d40ee1e49c <span class="ex">/boot</span> ext4 defaults,noatime 0 2</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="va">UUID=</span>3D6A-2654 <span class="ex">/boot/efi</span> vfat defaults,noatime 0 2</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a><span class="ex">tmpfs</span> /tmp tmpfs defaults,nosuid,nodev 0 0</span></code></pre></div>
<h2 id="instalando-e-configurando-o-grub-e-outros-pacotes">Instalando e configurando o Grub e outros pacotes</h2>
<p>Adicionaremos o módulo btrfs no dracut e também uma linha de referência ao diretório temporário:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&#39;add_dracutmodules+=&quot;btrfs&quot;&#39;</span> <span class="op">&gt;&gt;</span> /etc/dracut.conf</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&#39;tmpdir=&quot;/tmp&quot;&#39;</span> <span class="op">&gt;&gt;</span> /etc/dracut.conf</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="bu">echo</span> <span class="st">&#39;hostonly=&quot;yes&quot;&#39;</span> <span class="op">&gt;&gt;</span> /etc/dracut.conf</span></code></pre></div>
<p>Instale o Grub:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="ex">xbps-install</span> grub-x86_64-efi</span></code></pre></div>
<p>Como tenho placa Nvidia e Intel no laptop, adicionei nvidia-drm.modeset=1 e i915.modeset=1 na configuração do Grub em /etc/default/grub. Pode pular esta etapa caso não tenha.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="va">GRUB_CMDLINE_LINUX_DEFAULT=</span><span class="st">&quot;loglevel=4 slub_debug=P page_poison=1 nvidia-drm.modeset=1 i915.modeset=1&quot;</span></span></code></pre></div>
<p>Reconfigurando dracut:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="ex">dracut</span> --force --hostonly --kver 5.8.14_1 <span class="co">#coloque a versão do seu kernel</span></span></code></pre></div>
<p>Instalando o bootloader:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="ex">grub-install</span> --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=void_grub --boot-directory=/boot --recheck --debug</span></code></pre></div>
<p>Caso apareça o erro “EFI variables are not supported on this system”, abra um outro terminal (que estará fora do Void Linux) e digite:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="fu">mount</span> -B /sys/firmware/efi/efivars /mnt/sys/firmware/efi/efivars</span></code></pre></div>
<p>Rode novamente o comando para instalar o Grub.</p>
<p>Vamos nos certificar de que todos os pacotes estão devidamente configurados:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="ex">xbps-reconfigure</span> -fa</span></code></pre></div>
<p>Instalo agora os drivers de vídeo, Xorg e também o iwd e openresolv para conectar a internet:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="ex">xbps-install</span> void-repo-nonfree</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="ex">xbps-install</span> nvidia xf86-video-intel xf86-video-fbdev intel-video-accel mesa-vulkan-intel</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="ex">xbps-install</span> xorg-minimal xf86-input-evdev</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a><span class="ex">xbps-install</span> iwd openresolv</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a><span class="ex">xbps-install</span> NetworkManager <span class="co"># caso queira utilizar o NetworkManager para conectar a internet</span></span></code></pre></div>
<p>O seu sistema está pronto para bootar. Pode instalar tudo o que quiser agora antes de reiniciar. Fica a seu critério.</p>
<p>Saindo do chroot e reiniciando:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="bu">exit</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="fu">umount</span> -R /mnt</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="ex">shutdown</span> -r now</span></code></pre></div>
<h2 id="configurando-a-internet-e-finalizando">Configurando a internet e finalizando</h2>
<p>Remova o pendrive, ligue o computador e logue como root.</p>
<p>Para conectar o wifi com o iwd, é necessário adicionar os serviços ao sistema.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="fu">ln</span> -s /etc/sv/dbus /var/service/</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="fu">ln</span> -s /etc/sv/iwd /var/service/</span></code></pre></div>
<p>Para utilizar o iwd você encontra vários tutoriais na internet, ele é muito mais estável e simples do que o wpa_supplicant. Aqui só irei ensinar como configurá-lo para utilizar o cliente dhcp interno e o openresolv.</p>
<p>Edite ou crie o arquivo /etc/iwd/main.conf e coloque:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>[<span class="ex">General</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="va">EnableNetworkConfiguration=</span>true</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>[<span class="ex">Network</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="va">NameResolvingService=</span>resolvconf</span></code></pre></div>
<p>Se for utilizar o NetworkManager para conectar a internet, ele também pode ser configurado para utilizar o iwd e openresolv.</p>
<p>Crie um arquivo em /etc/NetworkManager/conf.d/ com o nome de sua preferência, como rc-manager.conf por exemplo, e coloque:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>[<span class="ex">main</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="ex">rc-manager</span>=resolvconf</span></code></pre></div>
<p>Para utilizar o iwd crie outro arquivo em /etc/NetworkManager/conf.d/, como wifi.conf, com o seguinte conteúdo:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>[<span class="ex">device</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="ex">wifi.backend</span>=iwd</span></code></pre></div>
<p>Coloque o serviço para iniciar:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="fu">ln</span> -s /etc/sv/NetworkManager /var/service/</span></code></pre></div>
<p>Feito. Utilize o NetworkManager normalmente como utilizaria em qualquer outro sistema.</p>
<p>Agora é só prosseguir normalmente, criando seu usuário (coloque ele no grupo network para poder conectar a internet e utilizar o NetworkManager). Logado no seu usuário é só se conectar à internet, instalar os programas que quiser e por fim começar a utilizar uma das distribuições Linux mais enxutas e rápidas atualmente!</p>
</body>
</html>
